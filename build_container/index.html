
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pmitev.github.io/UPPMAX-Singularity-workshop/build_container/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.9">
    
    
      
        <title>Building a container - UPPMAX: Singularity workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.120efc48.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.9647289d.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#building-your-first-container" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="UPPMAX: Singularity workshop" class="md-header__button md-logo" aria-label="UPPMAX: Singularity workshop" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UPPMAX: Singularity workshop
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Building a container
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pmitev/UPPMAX-Singularity-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="UPPMAX: Singularity workshop" class="md-nav__button md-logo" aria-label="UPPMAX: Singularity workshop" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    UPPMAX: Singularity workshop
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pmitev/UPPMAX-Singularity-workshop" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        How to install
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../remote_builder/" class="md-nav__link">
        Building remotely
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../fakeroot/" class="md-nav__link">
        Building with --fakeroot
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          First steps
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="First steps" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          First steps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Building a container
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Building a container
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple-singularity-definition-file" class="md-nav__link">
    Simple Singularity definition file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-container" class="md-nav__link">
    Building the container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-singularity-container" class="md-nav__link">
    Run the Singularity container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax-of-the-definition-file" class="md-nav__link">
    Syntax of the definition file
  </a>
  
    <nav class="md-nav" aria-label="Syntax of the definition file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header-bootsrap-agents-online-documentation" class="md-nav__link">
    header: Bootsrap agents - online documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#header-from" class="md-nav__link">
    header: From
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post" class="md-nav__link">
    %post
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    %environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runscript" class="md-nav__link">
    %runscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brief-summary-with-examples-online-documentation" class="md-nav__link">
    Brief summary with examples - online documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all-sections-online-documentation" class="md-nav__link">
    All sections - online documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../own_container/" class="md-nav__link">
        Build own container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../running_singularity/" class="md-nav__link">
        Running Singularity container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../remote_repositories/" class="md-nav__link">
        Running containrs from online repositories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../PyTorch_NVIDIA/" class="md-nav__link">
        NVIDIA Deep Learning Frameworks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Exercises
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Exercises" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Exercises
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise_00/" class="md-nav__link">
        Something easy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise_01/" class="md-nav__link">
        Real-life example
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../inspect/" class="md-nav__link">
        Inspect containers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise_02/" class="md-nav__link">
        Upload to Sylabs container library
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exercise_04/" class="md-nav__link">
        VSCode in Singularity
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../goods_bads/" class="md-nav__link">
        Goods and bads
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Advanced
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mpi_applications/" class="md-nav__link">
        Singularity and MPI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openmpi-benchmark/" class="md-nav__link">
        Singularity MPI@Kebnekaise
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../indirect-call/" class="md-nav__link">
        Indirect calls
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../uppmax_in_a_can/" class="md-nav__link">
        UPPMAX in a can
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../practical_information/" class="md-nav__link">
        Practical information
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#simple-singularity-definition-file" class="md-nav__link">
    Simple Singularity definition file
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-the-container" class="md-nav__link">
    Building the container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-the-singularity-container" class="md-nav__link">
    Run the Singularity container
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syntax-of-the-definition-file" class="md-nav__link">
    Syntax of the definition file
  </a>
  
    <nav class="md-nav" aria-label="Syntax of the definition file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#header-bootsrap-agents-online-documentation" class="md-nav__link">
    header: Bootsrap agents - online documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#header-from" class="md-nav__link">
    header: From
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post" class="md-nav__link">
    %post
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment" class="md-nav__link">
    %environment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runscript" class="md-nav__link">
    %runscript
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brief-summary-with-examples-online-documentation" class="md-nav__link">
    Brief summary with examples - online documentation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#all-sections-online-documentation" class="md-nav__link">
    All sections - online documentation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
  <a href="https://github.com/pmitev/UPPMAX-Singularity-workshop/edit/main/docs/build_container.md" title="Edit this page" class="md-content__button md-icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>



<h1 id="building-your-first-container">Building your first container</h1>
<p>In this simple example we will build Singularity container that will run the following programs <code>fortune | cowsay | lolcat</code> by installing all necessary libraries and packages within Ubuntu 16.04 Linux distribution setup.</p>
<h2 id="simple-singularity-definition-file">Simple Singularity definition file</h2>
<div class="admonition note">
<p class="admonition-title">Singularity.lolcow</p>
<div class="highlight"><pre><span></span><code><span class="k">BootStrap</span>:<span class="w"> </span>docker
<span class="k">From</span>:<span class="w"> </span>ubuntu:<span class="m">16.04</span>

<span class="gh">%post</span><span class="w"></span>
<span class="w">  </span>apt-get -y update
  apt-get -y install fortune cowsay lolcat

<span class="gh">%environment</span><span class="w"></span>
<span class="w">  </span><span class="nb">export</span> <span class="nv">LC_ALL</span><span class="o">=</span>C
  <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/usr/games:<span class="nv">$PATH</span>

<span class="gh">%runscript</span><span class="w"></span>
<span class="w">  </span>fortune <span class="p">|</span> cowsay <span class="p">|</span> lolcat
</code></pre></div>
</div>
<h2 id="building-the-container">Building the container</h2>
<div class="highlight"><pre><span></span><code>$ sudo singularity build lolcow.sif Singularity.lolcow

Starting build...
Getting image <span class="nb">source</span> signatures
Copying blob 4007a89234b4 <span class="k">done</span>  
Copying blob 5dfa26c6b9c9 <span class="k">done</span>  
Copying blob 0ba7bf18aa40 <span class="k">done</span>  
Copying blob 4c6ec688ebe3 <span class="k">done</span>  
Copying config 24336f603e <span class="k">done</span>  
Writing manifest to image destination
Storing signatures

...

INFO:    Adding environment to container
INFO:    Adding runscript
INFO:    Creating SIF file...
INFO:    Build complete: lolcow.sif
</code></pre></div>
<h2 id="run-the-singularity-container">Run the Singularity container</h2>
<p><div class="highlight"><pre><span></span><code>$ ./lolcow.sif 
_________________________________________
/ You will stop at nothing to reach your  \
| objective, but only because your brakes |
\ are defective.                          /
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
</code></pre></div>
<strong>-=&gt;&gt;&gt; Done &lt;&lt;&lt;=-</strong></p>
<p><img alt="lolcow" src="../images/lolcow.gif" /> <a href="https://asciinema.org/a/469408">asciinema</a></p>
<h2 id="syntax-of-the-definition-file">Syntax of the definition file</h2>
<div class="admonition note">
<p class="admonition-title">Singularity.lolcow</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="k">BootStrap</span>:<span class="w"> </span>docker
<span class="k">From</span>:<span class="w"> </span>ubuntu:<span class="m">16.04</span>

<span class="gh">%post</span><span class="w"></span>
<span class="w">  </span>apt-get -y update
  apt-get -y install fortune cowsay lolcat

<span class="gh">%environment</span><span class="w"></span>
<span class="w">  </span><span class="nb">export</span> <span class="nv">LC_ALL</span><span class="o">=</span>C
  <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/usr/games:<span class="nv">$PATH</span>

<span class="gh">%runscript</span><span class="w"></span>
<span class="w">  </span>fortune <span class="p">|</span> cowsay <span class="p">|</span> lolcat
</code></pre></div>
</td></tr></table>
</div>
<h3 id="header-bootsrap-agents-online-documentation"><em>header</em>: Bootsrap agents - <a href="https://sylabs.io/guides/3.8/user-guide/definition_files.html#preferred-bootstrap-agents">online documentation</a></h3>
<ul>
<li><code>library</code> - images hosted on the <a href="https://cloud.sylabs.io/library">Container Library</a></li>
<li><code>docker</code> - images hosted on <a href="https://hub.docker.com/">Docker Hub</a></li>
<li><code>shub</code> - images hosted on <a href="https://singularityhub.com/">Singularity Hub</a></li>
<li>...</li>
<li>Other: <code>localimage</code>, <code>yum</code>, <code>debootstrap</code>, <code>oci</code>, <code>oci-archive</code>, <code>docker-daemon</code>, <code>docker-archive</code>, <code>arch</code>, <code>busybox</code>, <code>zypper</code></li>
</ul>
<h3 id="header-from"><em>header</em>: From</h3>
<p>Depending on the value assigned to <code>Bootstrap</code>, other keywords may also be valid in the header. For example, when using the <code>library</code> bootstrap agent, the <code>From</code> keyword becomes valid.</p>
<h3 id="post">%post</h3>
<p>This section is where you can download files from the Internet, install new software and libraries, write configuration files, create new directories, etc.</p>
<h3 id="environment">%environment</h3>
<p>The <code>%environment</code> section allows you to define environment variables that will be set at runtime.</p>
<h3 id="runscript">%runscript</h3>
<p>The contents of the <code>%runscript</code> section are written to a file within the container that is executed when the container image is run (either via the <code>singularity run</code> command or by executing the container directly as a command)</p>
<h3 id="brief-summary-with-examples-online-documentation">Brief summary with examples - <a href="https://sylabs.io/guides/3.8/user-guide/cli/singularity_build.html?highlight=sandbox#examples">online documentation</a></h3>
<h3 id="all-sections-online-documentation">All sections - <a href="https://sylabs.io/guides/3.8/user-guide/definition_files.html#sections">online documentation</a></h3>
<h1 id="other-simple-examples">Other simple examples</h1>
<h2 id="tex-live">TeX Live</h2>
<p>You need to use recent <a href="https://www.tug.org/texlive/">TeX Live</a> but you do not want to (or you can't) upgrade your OS to the latest release... or you do not want to struggle unnecessary to make manual installation that has countless dependencies...</p>
<div class="admonition note">
<p class="admonition-title">Singularity.texlive</p>
<div class="highlight"><pre><span></span><code><span class="k">Bootstrap</span>:<span class="w"> </span>docker
<span class="k">From</span>:<span class="w"> </span>ubuntu:latest

<span class="gh">%post</span><span class="w"></span>
<span class="w">  </span><span class="nb">export</span> <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive
  apt-get update <span class="o">&amp;&amp;</span> apt-get -y dist-upgrade <span class="o">&amp;&amp;</span> apt-get install -y texlive-full <span class="o">&amp;&amp;</span> apt-get clean

<span class="gh">%runscript</span><span class="w"></span>
<span class="w">  </span>/bin/bash <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<p><div class="highlight"><pre><span></span><code>$ sudo singularity build texlive.sif Singularity.texlive

$ ./texlive.sif
</code></pre></div>
In this case, running the container will bring you to the bash prompt within latest Ubuntu release and the corresponding <code>texlive-full</code> package. Keep in mind that the shell is running within the container and this setup does not have any other tools like <code>git</code>, <code>wget</code>, <code>vim</code> etc.<br />
If you want them available in the container, do you know where to add them?</p>
<h2 id="installing-software-from-a-local-package">Installing software from a local package</h2>
<p>Sometimes, you cannot download a package directly or the software needs signing licenses. In this case you need to push in the locally downloaded file during the build process. You can get the latest version of the file bellow from here: https://jp-minerals.org/vesta/en/download.htm (<em>download the the linux <code>VESTA-gtk3.tar.bz2</code> version</em>).</p>
<div class="admonition note">
<p class="admonition-title">Singularity.vesta</p>
<div class="highlight"><pre><span></span><code><span class="k">Bootstrap</span>:<span class="w">  </span>docker
<span class="k">From</span>:<span class="w"> </span>ubuntu:<span class="m">20.04</span>

<span class="gh">%files</span><span class="w"></span>
<span class="w">  </span>VESTA-gtk3.tar.bz2 / 

<span class="gh">%post</span><span class="w"></span>
<span class="w">  </span><span class="nb">export</span> <span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive

  apt-get update <span class="o">&amp;&amp;</span> apt-get -y dist-upgrade <span class="o">&amp;&amp;</span> <span class="se">\</span>
  apt-get install -y libxmu6 libxss1 libxft2 libquadmath0 libpng16-16 bzip2 libgl1-mesa-glx <span class="se">\</span>
  libglu1-mesa libglib2.0-0 libgtk-3-0 libgtk-3-dev libgomp1 <span class="o">&amp;&amp;</span> <span class="se">\</span>
  apt-get clean

  <span class="nb">cd</span> /
  tar -C /usr/local -xvf /VESTA-gtk3.tar.bz2 <span class="o">&amp;&amp;</span> rm /VESTA-gtk3.tar.bz2    

<span class="gh">%runscript</span><span class="w"></span>
<span class="w">  </span>/usr/local/VESTA-gtk3/VESTA <span class="s2">&quot;</span><span class="nv">$@</span><span class="s2">&quot;</span>
</code></pre></div>
</div>
<p>Note the <code>%files</code> section. The line bellow will copy
<code>VESTA-gtk3.tar.bz2</code> from the current directory to the root folder 
<code>\</code> in the Singularity container. Also, you need to figure out yourself all required libraries and dependencies and install them.</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      <a href="https://uppmax.uu.se/" target="_blank" rel="noopener"><img align="right" alt="Uppsala" src="https://pmitev.github.io/to-awk-or-not/images/Uppsala.png" /> </a>
      <a href="https://snic.se/" target="_blank" rel="noopener"><img align="right" alt="SNIC" src="https://pmitev.github.io/to-awk-or-not/images/SNIC.png" /> </a>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.2a1c317c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6e54b5cd.min.js"></script>
      
        <script src="../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>